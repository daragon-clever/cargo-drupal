{{ attach_library('cogex/style-recherche-pdf') }}

<div class="container">
    <div id="module-search-pdf">
        {% if type == 'det' %}
            <div class="banner">
                <div class="banner-content">
                    <h1>Informations sur les détergents Turbocar</h1>
                    <p>Pour télécharger les informations détergents, merci de saisir le <span>numéro de lot</span> et
                        la <span>référence du produit</span> :</p>
                </div>
            </div>
            <div class="content">
                <div class="box-img">
                    <img src="/sites/cogex/themes/cogex/images/cgx_pdf_01.jpg" alt="Det">
                </div>
                <div class="box-chercher">
                    <form id="recherchepdf-form" name="formSearchDet" action="{{ path('resultSearch.form') }}"
                          onsubmit="return validateFormDet()" type="POST">
                        <div class="form-group">
                            <label>Référence du produit</label>
                            <input name="refProduit" class="refProduit" type="text" placeholder="Saisir une référence" required>
                        </div>
                        <div class="form-group">
                            <label>Lot du produit</label>
                            <input name="lotProduit" class="lotProduit" type="text" placeholder="Saisir un lot" required>
                        </div>
                        <div>
                            <input name="urlRedirect" class="urlRedirect" value="" type="hidden">
                            <button type="submit">Télécharger</button>
                        </div>
                    </form>
                </div>
            </div>

        {% elseif type == 'not' %}
            <div class="banner">
                <div class="banner-content">
                    <h1>Notices des produits Turbocar</h1>
                    <p>Pour télécharger la notice d'un produit, merci de saisir la <span>référence du produit</span> :</p>
                </div>
            </div>
            <div class="content">
                <div class="box-img">
                    <img src="/sites/cogex/themes/cogex/images/cgx_pdf_02.jpg" alt="Not">
                </div>
                <div class="box-chercher">
                    <form id="recherchepdf-form" name="formSearchNot" action="{{ path('resultSearch.form') }}"
                          onsubmit="return validateFormNot()" type="POST">
                        <div class="form-group">
                            <label>Référence du produit</label>
                            <input name="refProduit" class="refProduit" type="text" placeholder="Saisir une référence" required>
                        </div>
                        <div>
                            <input name="urlRedirect" class="urlRedirect" value="" type="hidden">
                            <button type="submit">Télécharger</button>
                        </div>
                    </form>
                </div>
            </div>
        {% endif %}
    </div>
</div>

<script>
    /*Redirect after DL*/
    var pathname = window.location.pathname;
    $(".urlRedirect").attr("value",pathname);

    /*Check data*/
    function validateFormDet() {
        var refProduit = document.forms["formSearchDet"]["refProduit"].value;
        var lotProduit = document.forms["formSearchDet"]["lotProduit"].value;
        if (refProduit == "" && lotProduit == "") {
            alert("Veuillez saisir la référence du produit et le lot du produit");
            return false;
        } else {
            return true;
        }
    }
    /*Check data*/
    function validateFormNot() {
        var refProduit = document.forms["formSearchNot"]["refProduit"].value;
        if (refProduit == "") {
            alert("Veuillez saisir la référence du produit");
            return false;
        } else {
            return true;
        }
    }
    /*Move alert*/
    function moveAlert($) {
        if ($("div[role='alert']").length) {
            var myDiv = $("div[role='alert']");
            $(myDiv).insertBefore($('.content'));
            $("div[role='alert']").show();
        } else {
            setTimeout(moveAlert(), 1000);
        }
    }

    jQuery(document).ready(function($) {
        moveAlert($);
    });
</script>